<?xml version="1.0" encoding="UTF-8"?>

<!-- TEMPLATE
<World>
	<Region id="short" name="string">
		<Settings dimx="short" dimy="short" area_percent="float" complexity="float" granularity="int" />
		
		<ExitDirections north="bool" south="bool" west="bool" east="bool" />
		
		<Exits>
			<Exit name="string" destination_region="string" destination_location="string" >
				<Shape shape="RECT" extent_x="float" extent_y="float" />
				OR
				<Shape shape="CIRCLE" radius="float" />
			</Exit>
			...
		</Exits>
		
		<NamedObjectGroups>
			<NameObjectGroup name="string" object_group="string" priority="int" />
			...
		</NamedObjectGroups>
	
		<ObjectGroups>
			<ObjectGroup object_group="string" priority="int" number="int" probability="float" />
			...
		</ObjectGroups>	
		
		<Environments>
			<Environment height="float" name="string" />
			...
		</Environments>
		
		<SpawnGroups>
			<SpawnGroup group_name="string" number="int" />
			...
		</SpawnGroups>
		
		<ReviveLocation  location="string" />
		
	</Region>
</World>
-->



<World  start_region="region0" start_location="entry_south">
	
	<Region id="0" name="region0">
		<Settings dimx="64" dimy="64" area_percent="0.35" complexity="0.4" granularity="8" />
		
		<ExitDirections north="false" south="true" west="false" east="false" />
		
		<Exits>
			<Exit name="exit_south" destination_region="region1" destination_location="entry_north" >
				<Shape shape="RECT" extent_x="4.0" extent_y ="4.0" />
			</Exit>
		</Exits>
		
		<Environments>
			<Environment height="0.6" name="meadow" />
			<Environment height="1.0" name="hills" />
		</Environments>
		
		<Event trigger ="create_region" once = "true">
			<Effect>
				addLocation('LichLocation', {130,212});
				addLocation('TestLocation', {130,217});
				addArea('LichArea','circle',{130,212},6);
				tree = createObject('$tree', 'LichLocation');
			</Effect>
		</Event>
		
		<Event trigger ="create_region" once = "true">
			<Effect>
				peasant = createObject('peasant', {130,220});
				setRefName(peasant,'peasant');
			</Effect>
		</Event>
		
		
		<Event trigger ="player_moved" once = "true">
			<Condition>
				return (unitIsInArea(trigger.player,"LichArea"))
			</Condition>
			<Effect>
				createDialogue();
				addSpeaker(trigger.player,'warrior');
				addSpeaker(peasant, 'lumberjack');
				changeTopic('tree');
			</Effect>
		</Event>
		
		
		<!--
		<Event trigger ="player_moved" once = "true">
			<Condition>
				return (unitIsInArea(trigger.player,"LichArea"))
			</Condition>
			<Effect>
				deleteObject(tree);
				lich = createObject("lich", "LichLocation");
			</Effect>
		</Event>
		
		<Event trigger ="unit_die" once = "true">
			<Condition>
				return (trigger.unit == lich)
			</Condition>
			<Effect>
				dropItem('demon_sw', getObjectValue(lich,'position'));
			</Effect>
		</Event>
		-->
		
		
		<!--
		<Event trigger ="create_region" once = "true">
			<Effect>
				setDamageValue('trapdmg','fire_dmg',5,10);
				trap_active = false;
			</Effect>
		</Event>
		
		<Event trigger ="player_moved">
			<Condition>
				return (unitIsInArea(trigger.player,'LichArea') and trap_active == false)
			</Condition>
			<Effect>
				insertTrigger('trap_fire');
				addTriggerVariable('goal',trigger.player);
			</Effect>
		</Event>
		
		<Event trigger ="trap_fire">
			<Effect>
				if unitIsInArea(trigger.goal,'LichArea') then
					createProjectile('fire_ball','trapdmg',getObjectValue(tree,'position'),getObjectValue(trigger.goal,'position'),10.0,0.3 );
					startTimer('trap_fire',2000);
					addTriggerVariable('goal',trigger.goal);
					trap_active = true;
				else
					trap_active = false;
				end 
			</Effect>
		</Event>
		-->
		
		<!--
		<Event trigger ="player_moved" once="true">
			<Condition>
				return (unitIsInArea(trigger.player,'LichArea'))
			</Condition>
			<Effect>
				setCutsceneMode(true);
				pos = getLocation('LichLocation');
				x = pos[1];
				y = pos[2];
				createObject('goblin' ,{x-5,y});
				addUnitCommand(trigger.player,'walk',2000,{x+4,y});
				addUnitCommand(trigger.player,'walk',1900,{x,y-4});
				addUnitCommand(trigger.player,'walk',1800,{x-4,y});
				addUnitCommand(trigger.player,'walk',1700,{x,y+4});
				addUnitCommand(trigger.player,'walk',1700,{x,y});
				addUnitCommand(trigger.player,'attack',1700,{x,y});
				addCameraPosition(0,pos, 270,70, 20);
				addCameraPosition(1000,pos, 0,45, 10);
				addCameraPosition(1000,pos, 90,45, 10); 
				addCameraPosition(1000,pos, 180,45, 10); 
				addCameraPosition(1000,pos, 270,45, 10); 
				addCameraPosition(2000,pos, 270,70, 20);
			</Effect>
		</Event>
		
		<Event trigger ="command_complete" once="true">
			<Condition>
				return (trigger.command == 'attack')
			</Condition>
			<Effect>
				deleteObject(tree);
				setCutsceneMode(false);
			</Effect>
		</Event>
		-->
	</Region>
	
	
	<Region id="1" name="region1">
		<Settings dimx="32" dimy="32" area_percent="0.35" complexity="0.4" granularity="8" />
		
		<ExitDirections north="true" south="false" west="false" east="false" />
		
		<Exits>
			<Exit name="exit_north" destination_region="region0" destination_location="entry_south" >
				<Shape shape="RECT" extent_x="4.0" extent_y ="4.0" />
			</Exit>
		</Exits>
		
		<NamedObjectGroups>
			<NameObjectGroup name="ort1" object_group="test2" priority="4" />
			<NameObjectGroup name="ort2" object_group="test1" priority="3" />
			<NameObjectGroup name="ort3" object_group="test1" priority="2" />
		</NamedObjectGroups>
	
		<ObjectGroups>
			<ObjectGroup object_group="trees3" priority="4" number="2" probability="1.0" />
			<ObjectGroup object_group="trees2" priority="2" number="5" probability="0.7" />
			<ObjectGroup object_group="trees1" priority="1" number="50" probability="0.5" />
		</ObjectGroups>
		
		<Environments>
			<Environment height="0.2" name="meadow" />
			<Environment height="1.0" name="hills" />
		</Environments>
		
		<SpawnGroups>
			<SpawnGroup group_name="lich_skeletons" number="1" />
			<SpawnGroup group_name="goblins" number="10" />
			<SpawnGroup group_name="goblins_dogs" number="10" />
		</SpawnGroups>
		
		<ReviveLocation  location="entry_north" />
		
		<Event trigger ="create_region" once = "true">
			<Effect>
				lich = createObject("lich", "ort1:center");
			</Effect>
		</Event>
		
		<Event trigger ="create_region" once = "true">
			<Effect>
				lich = createObject("lich", "ort2:center");
			</Effect>
		</Event>
		
		<Event trigger ="create_region" once = "true">
			<Effect>
				lich = createObject("lich", "ort3:center");
			</Effect>
		</Event>

	</Region>
</World>


