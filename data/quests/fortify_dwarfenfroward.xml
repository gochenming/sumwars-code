<Quest name="Fortify Dwarfenfroward" table_name="fortify_dwarfenfroward">
	
	<Init>
		local a = 2
	</Init>
	
	<Description>
		if (fortify_dwarfenfroward.finished) then
			return _("Quest finished")
		else
			return _("Quest description")
		end
	</Description>
	
	<NPC refname="Soren Windclaw">
		<!--
		<Topic name="fortify_dwarfenfroward" start_option="Defend Dwarfenfroward">
			<Condition>
				if (fortify_dwarfenfroward.finished ~= true and fortify_dwarfenfroward.freed ~= true) then
					return true
				else
					return false
				end
			</Condition>
			<Effect>
				insertTrigger("start_fortify_dwarfenfroward")
			</Effect>
		</Topic>
		-->
		<Topic name="scene1_dialogue">
			<Effect>
				addCameraPosition(0,get(getRole("PL"),"position"),20,40,20);
				addCameraPosition(20000,get(getRole("PL"),"position"),220,60,30);
				
				-- Die Helden werden von mehreren Waechtern durch einen Gang geführt.
				-- Rechts und Links kann man aus den Keller merkwuerdige Geraeusche hoeren
				-- und Magisch anmutende Dinge sehen.
				
				speak("MAG",_("As if that show would impress anyone..."),1500);
				speak("WAR",_("Of course! We're at the Council of Summoners"),1800);
				speak("WAR",_("and you're still talking big?!"),1400);
				speak("MAG",_("Why exactly was it that I put up with your company?"),1900);
				speak("PL",_("Hush! You can argue later."),1200);
				speak("W1",_("We're here."),1000);
				
				-- Die Tuer wird geoeffnet und die Gruppe tritt in einen Art geheimen
				-- Verschwoerungsraum. Das Licht ist reduziert und roetlich. Alles deutet
				-- auf schmerzhafte Experimente hin. Auf einem erhoehten Podest steht ein
				-- hoch gewachsener Magier mit dem Ruecken zur Gruppe.
				
				speak("ANYast",_("Do you feel that??!"),1000);
				speak("ANYast",_("It feels like..."),1000);
				speak("PL",_("Quiet!"),1000);
				speak("W2",_("My Lord! The... Branded Ones are here now."),1600);
				speak("SW",_("Very well."),1000);
				speak("SW",_("You're presence is no longer 	needed."),1500);
				speak("W1",_("But my Lord, those are"),1200);
				speak("SW",_("..."),2000);
				speak("W1",_("As you wish. My apologies."),1300);
				speak("W2",_("Come on, he knows what he's doing."),1400);
				
				-- Beide Wachen verschwinden aus dem Raum.
				
				speak("MAG",_("Nice shack!"),1000);
				speak("WAR",_("Well, the corners are a bit dirty though."),1600);
				speak("PRIast",_("Those ritual objects have seen better times, too."),1800);
				speak("SW",_("Yes, they warned me that you're difficult."),1600);
				speak("WAR",_("Difficult?"),1000);
				speak("WAR",_("You're putting in so much efford,"),1400);
				speak("WAR",_("and everything you get is 'difficult'."),1500);
				speak("MAG",_("Pft. I feel like flaring off the whole place."),1600);
				speak("ANYast",_("With all those wimps here it's not really worth the efford, isn't it?"),2100);
				speak("PL",_("The elemental guards might be a hassle..."),1500);
				speak("PRIast",_("I know this nice little ban..."),1400);
				speak("SW",_("Would you please take a quick look at this crystall."),2000);
				
				-- Er haelt einen Kristall in die Luft. Die Gruppe verstummt sofort und
				-- dreht sich in Richtung des Gegenstandes.
				
				speak("ANY",_("Is that a...?"),1000);
				speak("SW",_("Quite so."),1000);
				speak("SW",_("It is a crystall straight from the heart of Harad's hell."),2000);
				speak("PL",_("How is it possible that you're still alive?"),1500);
				speak("SW",_("Indeed the right question."),1200);
				speak("SW",_("With an answer, that could release every one of you from your suffering."),2100);
				speak("SW",_("But before I give it to you, you have to do something for me."),2000);
				speak("ANYast",_("May Harad curse you!"),1300);
				speak("SW",_("Maybe he has time for that after he is done with you."),1900);
				speak("SW",_("Until then you should remember that it is entirely in you hands"),2000);
				speak("SW",_("how long you will be under this curse."),1500);
				speak("SW",_("Fulfil my orders to the councils satisfaction"),1600);
				speak("SW",_("and I have the power to release you of the claws of the deathgod."),2000);
				speak("SW",_("If not, however..."),1000);
				speak("PL",_("We know that one allready. Cut the speach."),1600);
				speak("ANYast",_("What?!"),1000);
				speak("ANYast",_("The curse can be taken from us? Why do I hear this only know?"),2000);
				speak("SW",_("As you wish."),1000);
				speak("SW",_("The task is pretty dangerous and you are likely to die more than once."),2100);
				speak("PL",_("Harad's curse has to have some advantage."),1600);
				speak("WAR",_("If only the pain wasn't so bad everytime..."),1600);
				speak("MAG",_("Even here you have to whine."),1400);
				speak("SW",_("You are indeed a bunch of trying people."),1500);
				speak("MAG",_("He's beginning to make me angry."),1400);
				speak("PRIast",_("Peace!"),1000);
				speak("SW",_("The first thing you have to learn are obviously manners."),1700);
				speak("SW",_("Consider it as a small bonus:"),1300);
				speak("SW",_("Before your real assignment you will go to dwarfenfroward as backup."),2000);
				speak("SW",_("Show the undead there who the real favourite of the deathgod is."),2100);
				speak("PL",_("Smells like exploitation."),1200);
				speak("PRI",_("Besides the necromancers don't follow Harad."),1600);
				speak("ANYplus",_("This robegnome ranks pretty high among all the cheesy rats"),2000);
				speak("ANYplus",_("for whom we pulled chestnuts out of the fire."),1600);
				speak("SW",_("You obviously misjudge your position."),1500);
				speak("SW",_("What do you think will happen, if your revealed in town?."),1700);
				speak("SW",_("We know everything about your kind,"),1400);
				speak("SW",_("and believe me, no one will be stupid enough to kill you."),1700);
				
				addQuestion(_("Continue to be snotty?"));
				addAnswer(_("Yes"),"be_unkind");
				addAnswer(_("No"),"be_kind");
			</Effect>
		</Topic>
		
		<Topic name="be_unkind">
			<Effect>
				speak("PL",_("You consider yourself very mighty and clever, don't you?"),1700);
				speak("MAG",_("Surely he has written down that knowledge of his somewhere."),1800);
				speak("MAG",_("We can search for it after he's dead."),1500);
				speak("WAR",_("A good opportunity, indeed."),1300);
				speak("SW",_("Yes, they warned me about that, too."),1500);
				
				-- Er beschwoert einen kleinen Feuerelementar vor sich und haelt einen
				-- weiteren Kristall in die Luft.
				
				speak("SW",_("I will keep an eye on you and give you orders with this crystal."),1700);
				speak("SW",_("This simple elemental will remind you now that immortality has little meaning here."),2100);
				
				-- Die Gruppe kaempft gegen den Elementar. Es sollte ein schwerer Kampf
				-- sein, der aber schaffbar ist. Niemand stirbt, aber sobald die Chars
				-- auf 1% LE fallen, werden sie in einem Elementarkaefig gefangen, der
				-- jeden Handlungsspielraum unterbindet
				
				speak("SW",_("That was the weakest elemental I could possibly summon."),1700);
				speak("SW",_("Now go. I have no time to waste."),1300);
				speak("SW",_("The prince will marry soon and there are lots of preparations to make."),1800);
				
				changeTopic("end_cutscene1");
			</Effect>
		</Topic>
		
		<Topic name="be_kind">
			<Effect>
				speak("PL",_("Of course. With our freedom as the price"),1500);
				speak("PL",_("we will do everything in our might to be successful."),1700);
				speak("WAR",_("I don't like it."),1000);
				speak("SW",_("Very well."),1000);
				speak("SW",_("I must take care of the preparations for the princes wedding now."),1900);
				speak("SW",_("There is no time for further explanations."),1600);
				speak("SW",_("Take this crystall and some gold."),1400);
				speak("SW",_("I will send you orders with it when the time comes."),1600);
				
				-- Jeder der Gruppe erhält 200 GM. Anschließend verlassen sie den Saal.
				local players = getPlayers();
				local i,player;
				for i,player in ipairs(players) do
					if (getPlayerPrivateVar(player,"fortify_dwarfenfroward.reward") ~= true) then
						setPlayerPrivateVar(player,"fortify_dwarfenfroward.reward",true);
						setObjectValue(player,"gold", getObjectValue(player,"gold") + 200);
					end;
				end;
				
				changeTopic("end_cutscene1");
			</Effect>
		</Topic>
		
		<Topic name="end_cutscene1">
			<Effect>
				fortify_dwarfenfroward.scene1 = true;
				setCutsceneMode(false);
			</Effect>
		</Topic>
	</NPC>
	
	
	<Region name="elCnlLobby">
		<Event trigger="create_region" once="true">
			<Effect>
				fortify_dwarfenfroward_tmp.guard1 = createObject("peasant", "locSorenWindclaw");
				fortify_dwarfenfroward_tmp.guard2 = createObject("peasant", "locSorenWindclaw");
			</Effect>
		</Event>
		
		<Event trigger="player_moved" once="true">
			<Condition>
				if (fortify_dwarfenfroward.scene1 ~= true) then
					return (unitIsInArea(trigger.player,"SorenWindclawArea"));
				else
					return false;
				end;
			</Condition>
			<Effect>
				-- insertTrigger("start_scene")
				createDialogue();
				addSpeaker(soren_windclaw,"SW");
				addSpeaker(fortify_dwarfenfroward_tmp.guard1,"W1");
				addSpeaker(fortify_dwarfenfroward_tmp.guard2,"W2");
				addSpeaker(trigger.player,"Player");
				addStandardSpeakers();
				setCutsceneMode(true);
				setTopicBase("Soren Windclaw");
				changeTopic("scene1_dialogue");
			</Effect>
		</Event>
		<!--
		<Event trigger="start_scene">
			<Effect>
				-- setCutsceneMode(true);
				-- addCameraPosition(1000,get(getRole("PL"),"position"),20,50,25);
				-- startTimer("scene_1",1500);
			</Effect>
		</Event>
		
		<Event trigger="scene_1">
			<Effect>
				createDialogue();
				addSpeaker(soren_windclaw,"SW");
				addSpeaker(fortify_dwarfenfroward_tmp.guard1,"W1");
				addSpeaker(fortify_dwarfenfroward_tmp.guard2,"W2");
				addSpeaker(trigger.player,"Player");
				addStandardSpeakers();
				setTopicBase("Soren Windclaw");
				changeTopic("scene1_dialogue");
			</Effect>
		</Event>
		
		<Event trigger ="command_complete" once="true">
			<Effect>
				print(trigger.command);
				setCutsceneMode(false);
			</Effect>
		</Event>
		-->
	</Region>
	
</Quest>

